{% extends "core/base.html" %}
{% load static %}

{% block title %}Nuevo usuario · Pharmacontrol{% endblock %}

{% block content %}

<!-- APPBAR -->
<div class="appbar">
  <div class="crumbs">
    <a href="{% url 'users' %}">Usuarios</a> / <b>Nuevo</b>
  </div>
  <div class="spacer"></div>
</div>


  <!-- Encabezado -->
  <div class="page-header">
    <div>
      <div class="title">Crear usuario</div>
      <div class="subtitle">
        Da de alta a un usuario del sistema y define su rol de acceso.
      </div>
    </div>
  </div>

  <!-- Card del formulario -->
  <div class="form-container-card span-8" style="max-width:880px;">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h4 class="mb-0">Datos del usuario</h4>
      <span class="badge-soft">Farmacia actual: se asigna automáticamente</span>
    </div>
    <p class="text-muted" style="font-size:0.9rem;">
      Completa la información básica. Podrás editar estos datos posteriormente desde el módulo de usuarios.
    </p>

    {% if error %}
      <div class="alert alert-danger py-2">{{ error }}</div>
    {% endif %}

    <form method="post" action="{% url 'add_user' %}" class="row g-3 mt-1">
      {% csrf_token %}

      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-person"></i></span>
          <input
            name="nombre"
            class="form-control"
            placeholder="Nombre"
            value="{{ form.nombre|default:'' }}"
            required
          >
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Apellido</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-person-vcard"></i></span>
          <input
            name="apellido"
            class="form-control"
            placeholder="Apellido"
            value="{{ form.apellido|default:'' }}"
            required
          >
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Rol</label>
        <select name="rol" class="form-select" required>
          <option value="" disabled {% if not form.rol %}selected{% endif %}>Elige un rol…</option>
          <option value="admin"   {% if form.rol == "admin" %}selected{% endif %}>Admin</option>
          <option value="usuario" {% if form.rol == "usuario" %}selected{% endif %}>Usuario</option>
        </select>
        <div class="form-text">
          <span class="chip ok">Admin</span> Acceso total a todas las funciones· 
          <span class="chip info">Usuario</span> Vende los medicamentos que requieras.
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Correo electrónico</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-envelope"></i></span>
          <input
            type="email"
            name="email"
            class="form-control"
            placeholder="correo@dominio.com"
            value="{{ form.email|default:'' }}"
            required
          >
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Contraseña</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-shield-lock"></i></span>
          <input
            type="password"
            name="contraseña"
            class="form-control"
            placeholder="••••••••"
            minlength="8"
            required
          >
        </div>
        <div class="form-text">
          Mínimo 8 caracteres. Evita usar la misma contraseña que en otros sistemas.
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label">Confirmar contraseña</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-shield-check"></i></span>
          <input
            type="password"
            name="contraseña_confirm"
            class="form-control"
            placeholder="Repite la contraseña"
            minlength="8"
            required
          >
        </div>
      </div>

      <div class="col-12 d-flex gap-2 mt-3">
        <a href="{% url 'users' %}" class="btn btn-light">
          <i class="bi bi-arrow-left"></i> Cancelar
        </a>
        <button type="submit" class="btn btn-brand">
          <i class="bi bi-check2-circle"></i> Guardar usuario
        </button>
      </div>
    </form>
  </div>

{% endblock %}
